<!DOCTYPE html>
<html>
<head>
  <title>Accelerometer Example | Generic Sensor API | mobiForge</title>  
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="author" content="Ruadhan O'Donoghue">
  <meta charset="UTF-8">
</head>
<body>
  <h1>Accelerometer raw data</h1>
  <p><a href="https://mobiforge.com/design-development/the-generic-sensor-api">The Generic Sensor API</a> on <a href="https://mobiforge.com">mobiForge.com</a></p>
  <div id="status">No data</div>
  <!--<script>
    let status = document.getElementById('status');
    if ( 'Accelerometer' in window ) {
      let sensor = new Accelerometer();
      sensor.addEventListener('reading', function(e) {
        status.innerHTML = 'x: ' + e.target.x + '<br> y: ' + e.target.y + '<br> z: ' + e.target.z;
      });
      sensor.start();
    }
    else status.innerHTML = 'Accelerometer not supported';
  </script>-->

  <!--Get accelerometer data and print on webpage-->
  <script type="text/javascript" src="js/accelerometer.js"></script>

  <!--Send MQTT to thingsboard-->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/paho-mqtt/1.0.1/mqttws31.min.js" type="text/javascript"></script>
  <script type="text/javascript" language="javascript">
    var mqtt;
    var reconnectTimeout = 2000;
    var host="demo.thingsboard.io";
    var port=1883;
    var token="qMTW7oUorDcqoEA2z9xV";

    function onConnect(){
      console.log("Connected ");
      message = new Paho.MQTT.Message("{\"temperature\": \"25\"}");
      message.destinationName = "v1/devices/me/telemetry";
      mqtt.send(message);
    }
    function MQTTconnect(){
      console.log("connecting to " + host + " " + port);
      mqtt = new Paho.MQTT.Client(host,port,"prova");
      var options = {
        timeout: 3,
        onSuccess: onConnect,
        userName: token,
        password: "",
      };
      mqtt.connect(options);
    }
  </script>
  <script>
    MQTTconnect();
  </script>
</body>
</html>
